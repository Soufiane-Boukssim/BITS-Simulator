<div class="container">

  <!-- Success Message -->
  <div *ngIf="successMessage" class="success-message">
    {{ successMessage }}
    <button (click)="clearSuccessMessage()">Close</button>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
    <button (click)="clearErrorMessage()">Close</button>
  </div>


  <div class="identification">
    <h2>Identification</h2>
    <form class="form-grid">
      <div class="form-group small-input">
        <label for="profile">Profile:</label>
        <input type="text" id="profile" name="profile" [(ngModel)]="layout.id.profileCode" [attr.disabled]="isViewingDetails ? true : null">
      </div>

      <div class="form-group small-input">
        <label for="numero">Numero:</label>
        <input type="text" id="numero" name="numero" [(ngModel)]="layout.id.screenNumber" [attr.disabled]="isViewingDetails ? true : null">
      </div>

      <div class="form-group small-input">
        <label for="description">Description:</label>
        <input type="text" id="description" name="description" [(ngModel)]="layout.screenName" [attr.disabled]="isViewingDetails ? true : null">
      </div>

      <div class="form-group small-input">
        <label for="language">Language:</label>
        <select id="language" name="language" [(ngModel)]="layout.screenLanguage" [attr.disabled]="isViewingDetails ? true : null">
          <option value="en">English</option>
          <option value="fr">Français</option>
          <option value="esp">Español</option>
          <option value="ar">Arabic</option>
          <option value="esp">All language</option>
        </select>
      </div>
    </form>
  </div>

  <div class="buttons">
    <button (click)="showSection('layout')">Layout</button>
    <button (click)="showSection('textObject')">Text/Object</button>
    <button (click)="showSection('animatedScreen')">Ecran animé</button>
  </div>

  <div *ngIf="activeSection === 'layout'" class="section">
    <div class="attributes-container">
      <h3>Attribues</h3>
      <form class="form-grid">
        <div class="form-group">
          <label for="font">Police:</label>
          <select id="font" name="font" [(ngModel)]="layout.policeNumber" [attr.disabled]="isViewingDetails ? true : null">
            <option value="Graphique standard 2">Graphique standard 2</option>
            <option value="Graphique standard 3">Graphique standard 3</option>
            <option value="Alphanum 5 TS">Alphanum 5 TS</option>
            <option value="Alphanum 3 TS">Alphanum 3 TS</option>
            <option value="Alphanum 1 TD">Alphanum 1 TD</option>
            <option value="Graphique personalisee 3">Graphique personalisee 3</option>
            <option value="Chinois 1">Chinois 1</option>
            <option value="Chinois 2">Chinois 2</option>
          </select>
        </div>

        <div class="form-group">
          <label for="bgColor">Couleur de font:</label>
          <select id="bgColor" name="bgColor" [(ngModel)]="layout.bgColour" [attr.disabled]="isViewingDetails ? true : null">
            <option value="Couleur par defaut">Couleur par defaut</option>
            <option value="Noir">Noir</option>
            <option value="Rouge">Rouge</option>
            <option value="Vert">Vert</option>
            <option value="Bleu">Bleu</option>
            <option value="Jaune">Jaune</option>
            <option value="Blan">Blan</option>
          </select>
        </div>

        <div class="form-group">
          <label for="textColor">Couleur de text:</label>
          <select id="textColor" name="textColor" [(ngModel)]="layout.fgColour" [attr.disabled]="isViewingDetails ? true : null">
            <option value="Couleur par defaut">Couleur par defaut</option>
            <option value="Noir">Noir</option>
            <option value="Rouge">Rouge</option>
            <option value="Vert">Vert</option>
            <option value="Bleu">Bleu</option>
            <option value="Jaune">Jaune</option>
            <option value="Blan">Blan</option>
          </select>
        </div>

        <div class="form-group">
          <label for="line">Line:</label>
          <input type="number" id="line" name="line" [(ngModel)]="layout.lineNumber" value="0" [attr.disabled]="isViewingDetails ? true : null">
        </div>

        <div class="form-group">
          <label for="column">Colonne:</label>
          <input type="number" id="column" name="column" [(ngModel)]="layout.columnNumber" value="0" [attr.disabled]="isViewingDetails ? true : null">
        </div>

        <div class="form-group">
          <label for="blink">Clignotement:</label>
          <input type="checkbox" id="blink" name="blink" [(ngModel)]="layout.blinking" [attr.disabled]="isViewingDetails ? true : null">
        </div>

        <div class="form-group">
          <label for="clearScreen">Effacer écran:</label>
          <input type="checkbox" id="clearScreen" name="clearScreen" [(ngModel)]="layout.formFeedFlag" [attr.disabled]="isViewingDetails ? true : null">
        </div>
      </form>
    </div>

    <div class="voice-container">
      <h3>Voix</h3>
      <form class="form-grid">
        <div class="form-group">
          <label for="voice">Nom:</label>
          <select id="voice" name="voice" [(ngModel)]="layout.voiceNumber" [attr.disabled]="isViewingDetails ? true : null">
            <option value="Voice1">Voice1</option>
            <option value="Voice2">Voice2</option>
          </select>
        </div>

        <div class="form-group">
          <label for="concatenation">N.Concatenation:</label>
          <input type="number" id="concatenation" name="concatenation" [(ngModel)]="layout.numberConcatenation" value="0" [attr.disabled]="isViewingDetails ? true : null">
        </div>

        <div class="form-group">
          <label for="displayCarrierName">Afficher Nom Porteur:</label>
          <input type="checkbox" id="displayCarrierName" name="displayCarrierName" [(ngModel)]="layout.track1Name" (change)="toggleCarrierName($event)" [attr.disabled]="isViewingDetails ? true : null">
        </div>

        <div class="carrier-fields" *ngIf="displayCarrierName">
          <div class="form-group">
            <label for="carrierFont">Police:</label>
            <select id="carrierFont" name="carrierFont" [(ngModel)]="layout.currentPolice" [attr.disabled]="isViewingDetails ? true : null">
              <option value="Graphique standard 2">Graphique standard 2</option>
              <option value="Graphique standard 3">Graphique standard 3</option>
              <option value="Alphanum 5 TS">Alphanum 5 TS</option>
              <option value="Alphanum 3 TS">Alphanum 3 TS</option>
              <option value="Alphanum 1 TD">Alphanum 1 TD</option>
              <option value="Graphique personalisee 3">Graphique personalisee 3</option>
              <option value="Chinois 1">Chinois 1</option>
              <option value="Chinois 2">Chinois 2</option>
              </select>
          </div>

          <div class="form-group">
            <label for="carrierBgColor">Couleur de font:</label>
            <select id="carrierBgColor" name="carrierBgColor" [(ngModel)]="layout.currentBgColour" [attr.disabled]="isViewingDetails ? true : null">
              <option value="Couleur par defaut">Couleur par defaut</option>
              <option value="Noir">Noir</option>
              <option value="Rouge">Rouge</option>
              <option value="Vert">Vert</option>
              <option value="Bleu">Bleu</option>
              <option value="Jaune">Jaune</option>
              <option value="Blan">Blan</option>
              </select>
          </div>

          <div class="form-group">
            <label for="carrierLine">Line:</label>
            <input type="number" id="carrierLine" name="carrierLine" [(ngModel)]="layout.currentPositionX" value="0" [attr.disabled]="isViewingDetails ? true : null">
          </div>

          <div class="form-group">
            <label for="carrierColumn">Colonne:</label>
            <input type="number" id="carrierColumn" name="carrierColumn" [(ngModel)]="layout.currentPositionY" value="0" [attr.disabled]="isViewingDetails ? true : null">
          </div>
        </div>
      </form>
    </div>
  </div>

  <div *ngIf="activeSection === 'textObject'" class="section Text-Object-container">
    <h2>Text/Object</h2>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Objet</th>
            <th>Line</th>
            <th>Colonne</th>
            <th>Numero d'objet</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of textObjectItems; let i = index">
            <td>
              <select [(ngModel)]="layout.currentFgColour" [attr.disabled]="isViewingDetails ? true : null">
                <option value="Image">Image</option>
                <option value="Logo">Logo</option>
                <option value="Ecran">Ecran</option>
              </select>
            </td>
            <td>
              <input type="number" min="0" [(ngModel)]="item.line" placeholder="Line" [attr.disabled]="isViewingDetails ? true : null">
            </td>
            <td>
              <input type="number" min="0" [(ngModel)]="item.colonne" placeholder="Colonne" [attr.disabled]="isViewingDetails ? true : null">
            </td>
            <td>
              <input type="number" min="0" [(ngModel)]="item.numeroObjet" placeholder="Numero d'objet" [attr.disabled]="isViewingDetails ? true : null">
            </td>
          </tr>
        </tbody>
      </table>
      <div class="button-container">
        <button (click)="addTextObjectRow()">Ajouter une ligne</button>
        <button (click)="deleteAllTextObjectRow()">Supprimer tout</button>
      </div>
    </div>
  </div>

  <div *ngIf="activeSection === 'animatedScreen'" class="section animated-screen-container">
    <h2>Liste Ecrans Animées</h2>
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Ecran</th>
            <th>Ordre écran</th>
            <th>Temps</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let screen of screens; let i = index">
            <td>
              <select [(ngModel)]="layout.currentBlinking" [attr.disabled]="isViewingDetails ? true : null">
                <option value="Desc">Desc</option>
                <option value="D">D</option>
              </select>
            </td>
            <td>
              <input type="number" min="0" [(ngModel)]="screen.order" placeholder="Ordre écran" [attr.disabled]="isViewingDetails ? true : null">
            </td>
            <td>
              <input type="number" min="0" [(ngModel)]="screen.time" placeholder="Temps" [attr.disabled]="isViewingDetails ? true : null">
            </td>
          </tr>
        </tbody>
      </table>
      <div class="button-container">
        <button (click)="addRow()">Ajouter une ligne</button>
        <button (click)="deleteAll()">Supprimer tout</button>
      </div>
    </div>
  </div>

  <div class="crud-buttons">
    <!-- Bouton "Créer" -->
    <button *ngIf="!isEditing && !isViewingDetails" (click)="createLayout(layout)">Créer</button>
    
    <!-- Boutons pour le mode édition -->
    <div *ngIf="isEditing || isViewingDetails" class="crud-buttons2">
      <button *ngIf="isEditing" (click)="updateLayout()">Update</button>
      <button type="button" (click)="cancelEdit()" class="cancel-button">Cancel</button>
    </div>
  </div>
  
  <div class="filter-container">
    <div class="filter-group">
      <label for="profileFilter">Filter by Profile:</label>
      <input type="text" id="profileFilter" placeholder="Search by Profile" [(ngModel)]="profileFilter" (input)="applyFilters()">
    </div>
  
     



    <div class="filter-group">
      <label for="numeroFilter">Filter by Numero:</label>
      <input type="text" id="numeroFilter" placeholder="Search by Numero" [(ngModel)]="numeroFilter" (input)="applyFilters()">
    </div>
  </div>
    
  <!-- Table to display all database data -->
  <div class="all-layouts-table-container">
    <h2>All Layouts from Database</h2>
    <table>
      <thead>
        <tr>
          <th>Profile</th>
          <th>Numero</th>
          <th>Action</th>
        </tr>
      </thead>



    <tbody>
      <tr *ngFor="let layout of filteredLayouts">
        <td>{{ layout.id.profileCode }}</td>
        <td>{{ layout.id.screenNumber }}</td>
        <td class="action-buttons">
          <button class="edit-button" (click)="editLayout(layout)">Modifier</button>
          <button class="del-button" (click)="deleteLayout(layout.id.profileCode, layout.id.screenNumber)">Supprimer</button>
          <button class="view-button" (click)="viewDetails(layout)">Afficher</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="pagination">
    <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1">Previous</button>
    <button (click)="togglePageList()">Page {{ currentPage }} ▼</button>
    <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages || filteredLayouts.length === 0">Next</button>
  </div>

  <div *ngIf="showPageList" class="page-list">
    <button *ngFor="let page of [].constructor(totalPages); let i = index"
            (click)="goToPage(i + 1)"
            [class.active]="i + 1 === currentPage">{{ i + 1 }}</button>
  </div>
</div>